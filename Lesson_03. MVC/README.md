# ![Spring logo](https://github.com/InsaneDan/InsaneDan/blob/main/spring.png)

### Урок 3. Spring MVC
<details>
<summary>Spring MVC. Контроллеры. Работа с формами. Представления. Конфигурирование Spring MVC. Контекст Spring MVC.</summary>
  
1. Разобраться с примером проекта на Spring MVC.
2. Создать класс Товар (Product), с полями id, title, cost.
3. Товары необходимо хранить в репозитории (класс, в котором в виде List<Product> хранятся товары). Репозиторий должен уметь выдавать список всех товаров и товар по id.
4. Сделать форму для добавления товара в репозиторий и логику работы этой формы.
5. Сделать страницу, на которой отображаются все товары из репозитория.

Комментарии:

* Просмотр сведений о продукте, добавление нового продукта и редактирование существующего сделано в одной форме. ID продукта,
  если он есть, указывается в скрытом элементе формы.

    - Получение товара по id (только просмотр): GET запрос с параметрами view=1 и id, при отображении страницы - все поля
  формы disable (нельзя изменить, нельзя навести фокус, нельзя отправить).
    - Для редактирования сведений о товаре - GET запрос с указанием id; для сохранения изменений - POST ответ, список
  продуктов (HashMap) пересохраняет данные по ключу (id).
    - Для создания нового товара - GET без указания id; при сохранении данных (POST) подбирается новый id (= максимальный +
  1).

* После сохранения товара в репозитории @PostMapping("/edit/save") из формы редактирования выполняется редирект на
  страницу со списком продуктов.
* Удаление товара из репозитория @GetMapping("/delete"). После удаления выполняется редирект на эту же страницу со
  списком товаров (в идеале - сделать обновление только таблицы, а не всей страницы целиком).
* Контроллеры для корзины, контактов, главной страницы - пустые, содержат только маппинг, оставлены для перехода на
  соответствующие страницы.
* Неправильное отображение кириллицы - исправлено.
* Деплой и проверка на Tomcat 9.0 и Wildfly 23.0.0.

THYMELEAF
1. Шаблон default.html с разметкой для блоков <head>, <header> (панель навигации), <footer> (включает скрипты jquery и
   jsdelivr для элементов и разметки bootstrap). Блоки из шаблона переиспользуются на других страницах.
2. В разных вариациях использованы переменные ${...}, элементы списков *{...}, сообщения #{...}, ссылки @{...},
   фрагменты ~{...}
3. Форматирование чисел - в таблице товаров приведены к виду 0.00.
4. Циклы - нумерация строк в таблице товаров, повторение абзацев на главной странице.
5. Динамический выбор текста на элементах формы (Создать / Сохранить при изменении данных о товаре), отключение полей формы, .

Не получилось:
* Обновить таблицу (список продуктов) без перезагрузки страницы. В JSP и JPF для ajax'ов есть спец.тэг, в thymeleaf'е не
разобрался, как это сделать. 
* Добавление класса "active" (th:classappend) к элементам меню навигации. Меню добавляется из шаблона, который не обрабатывается ни одним из контроллеров. Передать в него аттрибут напрямую нельзя. Простого решения не нашел.
</details>
