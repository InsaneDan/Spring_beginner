# ![Spring logo](https://github.com/InsaneDan/InsaneDan/blob/main/spring.png)

### 1. Основы Java EE
<details>
<summary>Обзор Java EE-компонентов и введение в web-технологии. Что такое сервлеты. Слушатели. Фильтры.</summary>
  
1. Установить сервер приложений TomCat или Wildfly (либо любой другой по выбору);
2. Создать и запустить новый проект по инструкции из данной методички.
3. Создайте класс Product с полями (id, title, cost).
4. Реализуйте сервлет выводящий на страницу список из 10 продуктов (создаете продукты в момент обработки запроса).

Сервер приложений: WildFly-23.0.0.Final (старт сервера через stanalone.bat)
Реализация: HttpServlet + JSP (± подобие JPA, т.к. нет подключения к БД)
Для установки на сервер приложений - Run Maven goal: clean install wildfly:deploy

URL: http://127.0.0.1:8080/webapp/http-servlet - основные методы HttpServlet
URL: http://127.0.0.1:8080/webapp/product - список продуктов

Комментарии:
- Дескриптор развертывания. Файл web.xml содержит только служебную информацию, маппинг не прописан (используются аннотации @WebServlet(urlPatterns = "..."))
- Вывод списка продуктов: сервлет наследуется от HttpServlet, представление (persistence) - вынесено в отдельные классы (продукт и репозиторий). Для задания испольуются методы только для сохранения и получения списка продуктов из репозитория.
- Список продуктов для репозитория создается при инициализации сервлета (срабатывает ServletContextListener).
- Вывод страницы на сервере приложений с помощью JSP. При формировании страницы импортируется <head> и <navbar> из отдельных jsp-файлов. Страницы созданы с использованием css Bootstrap v4.3.
- SimpleHttpServlet - формирует html-текст для отображения страницы (HttpServletResponse) "вручную", страница содержит основные методы класса.
</details>

### 2. Введение в Spring
<details>
<summary>Введение в Spring. Dependency Injection и Inversion of Control. Бины. Spring Context. Конфигурирование.</summary>
  
1. Есть класс Product (id, название, цена). Товары хранятся в бине ProductRepository, в виде List<Product>, при старте в него нужно добавить 5 любых товаров.
2. ProductRepository позволяет получить весь список или один товар по id. Создаем бин Cart, в который можно добавлять и удалять товары по id.
3. Написать консольное приложение, позволяющее управлять корзиной.
4. При каждом запросе корзины из контекста, должна создаваться новая корзина.

Комментарии:
- компонент ProductRepository - является singletone; Cart - @Scope("prototype");
- наполнение productRepository товарами после создания бина (@PostConstruct);
- корзина в виде Map: ключ - продукты, значение - количество продукта в корзине;
- в CartServiceImpl использована аннотация @Autowired для метода setProductRepository. По большому счету внедрение продуктового репозитория в корзину не требуется - экспериментировал с @Autowired.
- для запуска - DemoApp.
</details>


### Урок 3. Spring MVC
<details>
<summary>Spring MVC. Контроллеры. Работа с формами. Представления. Конфигурирование Spring MVC. Контекст Spring MVC.</summary>
  
1. Разобраться с примером проекта на Spring MVC.
2. Создать класс Товар (Product), с полями id, title, cost.
3. Товары необходимо хранить в репозитории (класс, в котором в виде List<Product> хранятся товары). Репозиторий должен уметь выдавать список всех товаров и товар по id.
4. Сделать форму для добавления товара в репозиторий и логику работы этой формы.
5. Сделать страницу, на которой отображаются все товары из репозитория.

Комментарии:

* Просмотр сведений о продукте, добавление нового продукта и редактирование существующего сделано в одной форме. ID продукта,
  если он есть, указывается в скрытом элементе формы.

    - Получение товара по id (только просмотр): GET запрос с параметрами view=1 и id, при отображении страницы - все поля
  формы disable (нельзя изменить, нельзя навести фокус, нельзя отправить).
    - Для редактирования сведений о товаре - GET запрос с указанием id; для сохранения изменений - POST ответ, список
  продуктов (HashMap) пересохраняет данные по ключу (id).
    - Для создания нового товара - GET без указания id; при сохранении данных (POST) подбирается новый id (= максимальный +
  1).

* После сохранения товара в репозитории @PostMapping("/edit/save") из формы редактирования выполняется редирект на
  страницу со списком продуктов.
* Удаление товара из репозитория @GetMapping("/delete"). После удаления выполняется редирект на эту же страницу со
  списком товаров (в идеале - сделать обновление только таблицы, а не всей страницы целиком).
* Контроллеры для корзины, контактов, главной страницы - пустые, содержат только маппинг, оставлены для перехода на
  соответствующие страницы.
* Неправильное отображение кириллицы - исправлено.
* Деплой и проверка на Tomcat 9.0 и Wildfly 23.0.0.

THYMELEAF
1. Шаблон default.html с разметкой для блоков <head>, <header> (панель навигации), <footer> (включает скрипты jquery и
   jsdelivr для элементов и разметки bootstrap). Блоки из шаблона переиспользуются на других страницах.
2. В разных вариациях использованы переменные ${...}, элементы списков *{...}, сообщения #{...}, ссылки @{...},
   фрагменты ~{...}
3. Форматирование чисел - в таблице товаров приведены к виду 0.00.
4. Циклы - нумерация строк в таблице товаров, повторение абзацев на главной странице.
5. Динамический выбор текста на элементах формы (Создать / Сохранить при изменении данных о товаре), отключение полей формы, .

Не получилось:
* Обновить таблицу (список продуктов) без перезагрузки страницы. В JSP и JPF для ajax'ов есть спец.тэг, в thymeleaf'е не
разобрался, как это сделать. 
* Добавление класса "active" (th:classappend) к элементам меню навигации. Меню добавляется из шаблона, который не обрабатывается ни одним из контроллеров. Передать в него аттрибут напрямую нельзя. Простого решения не нашел.
</details>


### Урок 4. Spring MVC
<details>
<summary>Spring MVC. Контроллеры. Работа с формами. Представления. Конфигурирование Spring MVC. Контекст Spring MVC.</summary>
  
1. Перенести функциональность, реализованную на прошлом занятии, на платформу Spring Boot.

Комментарии:

Миграция в Spring Boot. Дополнения к проекту:
* Добавлено отображение активной страницы в меню навигации (передача параметра во фрагмент, содержащий меню, в зависимости от значения добавление класса th:classappend="active"). Т.к. меню присутствует на всех страницах, в контроллеры добавлены дефолтные методы с аннотацией @ModelAttribute("activePage").
* Добавлена страница со списком товаров в корзине, ценой, суммарной стоимостью.
* Добавление и удаление товаров в корзину на странице списка товаров, изменение количества (увеличить / уменьшить) в корзине.
* Товары в корзине выводятся с сортировкой по названию (в сервисе хранится HashMap на отображение отдается ArrayList)
* Изменена логика удаления товаров - добавление отрицательного количества продуктов; если количество становится <=0, то продукт удаляется из корзины.
* При добавлении/удалении товара в корзину, при переходе на страницу с описанием товара из корзины или из списка товаров для редиректа и  возврата на страницу, с которой был вызван маппинг, использован заголовок "referer" HttpServletRequest.
* Просмотр информации о продукте по клику на название (и в списке товаров, и в корзине), возврат обратно на "свою" страницу.

Не сделано:
* передать общее количество товаров в бэйдж корзины, который находится во фрагменте меню (работает только на странице корзины).
</details>


### Урок 5. Java Persistence API. Hibernate. Часть 1
<details>
<summary></summary>
  

Комментарии:

</details>

### Урок 6. Java Persistence API. Hibernate. Часть 2
<details>
<summary></summary>
  

Комментарии:

</details>

### Урок 7. Spring Data
<details>
<summary></summary>
  

Комментарии:

</details>

### Урок 8. Thymeleaf
<details>
<summary></summary>
  

Комментарии:

</details>

### Урок 9. Spring REST. Часть 1
<details>
<summary></summary>
  

Комментарии:

</details>

### Урок 10. Spring REST. Часть 2
<details>
<summary></summary>
  

Комментарии:

</details>

### Урок 11. Spring Security
<details>
<summary></summary>
  

Комментарии:

</details>

### Урок 12. Практика
<details>
<summary></summary>
  

Комментарии:

</details>
